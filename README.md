# PowerShell 7-Zip CRC32 Calculator

This PowerShell script provides functions to calculate CRC32 checksums for files and folders in a manner that is **100% compatible with the checksums generated by 7-Zip**. It is a pure PowerShell implementation that leverages .NET for high performance, requiring no external executables.

The script includes a simple graphical user interface (GUI) to allow users to easily select a file or folder for hashing.

## Description

Have you ever wanted to verify the integrity of a folder against a checksum provided by 7-Zip? 7-Zip's "CRC" and "hash" commands generate checksums using a specific, proprietary method, especially for folders. This script meticulously replicates that algorithm, allowing you to validate 7-Zip checksums without needing to have 7-Zip installed, or to generate compatible checksums for others to verify.

For folders, it calculates two distinct aggregate checksums:

1. **CRC32 checksum for data:** An aggregate of the CRC32 values of the data within each file.

2. **CRC32 checksum for data and names:** A more complex aggregate that includes the CRC32 of file data *and* the CRC32 of metadata, including file/folder names (encoded in UTF-16LE) and attributes.

## Features

- **7-Zip Compatibility:** Generates checksums identical to those from 7-Zip.
- **File & Folder Support:** Can operate on individual files or entire directory trees.
- **User-Friendly GUI:** Uses a simple Windows Forms dialog to pick files or folders.
- **Pure PowerShell:** Self-contained script with no external dependencies besides .NET.
- **High Performance:** Optimized for processing large files and directories efficiently.
- **Unicode Aware:** Correctly handles file and folder names with special characters, just like 7-Zip.

## Requirements

- Windows Operating System
- Windows PowerShell 5.1 or later

## How to Use

1. **Save the Script:** Save the code as a PowerShell file (e.g., `Get-7ZipCrc.ps1`).

2. **Run the Script:** Right-click the `.ps1` file and select **"Run with PowerShell"**.

3. **Make a Choice:** A dialog box will appear.
   - Click **`Yes`** to select a **file**.
   - Click **`No`** to select a **folder**.
   - Click **`Cancel`** to exit.

4. **Select Item:** A standard Windows file or folder browser dialog will open. Select the item you wish to hash.

5. **View Results:** Once the calculation is complete, the results will be printed to the PowerShell console window.

## Example Output

### For a File

```powershell
Path              : C:\Users\User\Documents\MyFile.zip
Type              : File
CRC32 checksum for data: 1A2B3C4D
```

### For a Folder

Path                              : C:\Users\User\Documents\MyProject
Type                              : Folder
IncludeRoot                       : True
CRC32 checksum for data           : A1B2C3D4-E5F6A7B8
CRC32 checksum for data and names : 11223344-55667788

Functions Overview
This script is composed of several core and helper functions:

Get-7ZipCrc32: The main entry point that determines if the path is a file or folder and calls the appropriate handler.

Get-7ZipFileCrc32: Handles CRC32 calculation for a single file.

Get-7ZipFolderCrc32Aggregates: The core logic for calculating 7-Zip's complex folder checksums. It iterates through all files and directories to aggregate their individual checksums.

Get-Crc32OfFileUInt32 / Get-Crc32OfBytesUInt32: Low-level functions that compute the standard CRC-32/IEEE checksum for a file stream or a byte array.

Update-Crc32*: Helper functions that apply the CRC32 algorithm to chunks of data.

Get-Crc32Table: Pre-calculates the CRC32 polynomial lookup table for fast computation.
::contentReference[oaicite:0]{index=0}
